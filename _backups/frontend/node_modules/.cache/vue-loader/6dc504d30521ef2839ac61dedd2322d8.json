{"remainingRequest":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\src\\views\\Estoque.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\src\\views\\Estoque.vue","mtime":1685755624334},{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Gabriel\\PycharmProjects\\kapiva_gestao_fastapi_vuejs\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLyo8c3R5bGUgc2NvcGVkPiovCi5hdXRvc3VnZ2VzdC1jb250YWluZXIgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgd2lkdGg6IDI4MHB4OwoKfQoKLmF1dG9zdWdnZXN0X19yZXN1bHRzIHsKICAgIHotaW5kZXg6IDEwMDA7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgLypqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsqLwogICAgLyp3aWR0aDogMjgwcHg7Ki8KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgICBiYWNrZ3JvdW5kLWNsaXA6IHBhZGRpbmctYm94OwogICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAuMTUpOwogICAgYm9yZGVyLXJhZGl1czogLjI1cmVtOwoKfQoKCg=="},{"version":3,"sources":["Estoque.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmnBA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Estoque.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"levantamento-row\">\r\n        <b-row>\r\n            <b-col sm=\"2\">\r\n\r\n                <b-form @submit.stop.prevent=\"updateEstoqueProdutos\">\r\n                    <b-button type=\"submit\" variant=\"primary\">Update Estoque Produtos</b-button>\r\n                </b-form>\r\n                <b/>\r\n                <b-form @submit.stop.prevent=\"readProdutosFromMongo\">\r\n                    <div class=\"autosuggest\">\r\n                            <b>Marca: </b>\r\n                            <vue-autosuggest\r\n                                    :get-suggestion-value=\"getSuggestionValue\"\r\n                                    :input-props=\"{id:'autosuggest__input', placeholder:'Digite a marca', class:'form-control'}\"\r\n                                    :suggestions=\"filteredOptions\" @click=\"clickHandler\" @focus=\"focusMe\"\r\n                                    @input=\"onInputChange\"\r\n                                    @selected=\"onSelected\"\r\n                                    v-model=\"marcas_suggestion_query\">\r\n                                <div class=\"autosuggest-container-results\" slot-scope=\"{suggestion}\"\r\n                                     style=\" align-items: center;\">\r\n                                    <div> {{suggestion.item.nom_marca}} ({{suggestion.item.cod_marca}})</div>\r\n                                </div>\r\n                            </vue-autosuggest>\r\n                        </div>\r\n\r\n                    <b-button type=\"submit\" variant=\"primary\">Read Produtos From Mongo</b-button>\r\n                </b-form>\r\n            </b-col>\r\n            <b-col sm=\"2\">\r\n                    <b-row>\r\n                        <label>Data Movto inicial: </label>\r\n                        <datepicker-ini v-model=\"data_movto_ini\" @change=\"receiveDataMovtoIni\"  placeholder=\"Selecione a data\"/>\r\n                        <br><br>\r\n                    </b-row>\r\n                    <b-row>\r\n                        <label>Data Movto final: </label>\r\n                        <datepicker-fim v-model=\"data_movto_fim\" @change=\"receiveDataMovtoFim\"  placeholder=\"Selecione a data\"/>\r\n                        <br><br>\r\n\r\n                    </b-row>\r\n                </b-col>\r\n            <b-col>\r\n                <div id=\"grades_check_box\">\r\n                        <b-row>\r\n                        <b-col :key=\"grade.name\" sm=\"6\" v-for=\"grade in grades_options\">\r\n\r\n                            <div class='form-check form-switch'>\r\n                                <div>\r\n                                    <input :value=\"grade\" class='form-check-input' type=\"checkbox\"\r\n                                           v-model=\"grades_selected\"/>\r\n                                    <label class='form-check-label'>{{grade.name}}</label>\r\n                                    <!--                        <br>-->\r\n                                </div>\r\n                            </div>\r\n\r\n                        </b-col>\r\n                    </b-row>\r\n                </div>\r\n            </b-col>\r\n        </b-row>\r\n        <b-row>\r\n            <b-input v-model=\"filter\" placeholder=\"Filtros OU separados por vírgulas\"></b-input>\r\n            <!--            <b-table :bordered=\"true\" :fields=\"computedFields\" :filter=\"filter\" :items=\"items\" :filter-function=\"filterFn\"-->\r\n<!--            <b-table :bordered=\"true\" :fields=\"computedFields\" :filter=\"filter\" :items=\"filteredItemsComputed\" :filter-function=\"filterFn\"-->\r\n            <b-table :bordered=\"true\" :fields=\"computedFields\" :filter=\"filter\" :items=\"filteredItemsComputed\" :filter-function=\"filterFn\"\r\n                 :small=true\r\n                 :sort-compare=\"dateSorter\" @row-clicked=\"expandAdditionalInfo\" class=\"text-right\" head-variant=\"light\" hover sticky-header=\"700px\"\r\n                 striped>\r\n\r\n            <template v-for=\"field in gradeFields\" v-slot:[`cell(${field.key})`]=\"{ item }\">\r\n                <div v-if=\"item.estoque_history[item.estoque_history.length-1]\"><!-- eslint-disable-line-->\r\n                    {{item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key+\"_E\"]}}<br>\r\n                <b>{{item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key]}}</b>\r\n<!--                    <div v-if=\"this.grade_estoque_totais[field.key+'_E']\">-->\r\n<!--                        {{this.grade_estoque_totais[field.key+\"_E\"] = this.grade_estoque_totais[field.key+\"_E\"] + item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key+\"_E\"]}}-->\r\n<!--                    </div>-->\r\n<!--                    <div v-else>-->\r\n<!--                        {{this.grade_estoque_totais[field.key+\"_E\"] = item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key+\"_E\"]}}-->\r\n<!--                    </div>-->\r\n<!--                    <div v-if=\"this.grade_estoque_totais[field.key]\">-->\r\n<!--                        {{this.grade_estoque_totais[field.key] = item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key]}}-->\r\n<!--                    </div>-->\r\n<!--                    <div v-else>-->\r\n<!--                        {{this.grade_estoque_totais[field.key] = item.estoque_history[item.estoque_history.length-1].grade_estoque[field.key]}}-->\r\n<!--                    </div>-->\r\n                </div>\r\n            </template>\r\n\r\n\r\n                <template v-slot:cell(saidas)=\"data\">\r\n                    <div v-if=\"data.item.estoque_history[data.item.estoque_history.length-1]\">\r\n                    {{data.item.estoque_history[0].saidas - data.item.estoque_history[data.item.estoque_history.length-1].saidas}}\r\n                    </div>\r\n                </template>\r\n\r\n                <template v-slot:cell(totais)=\"data\">\r\n                    <div v-if=\"data.item.estoque_history[data.item.estoque_history.length-1]\">\r\n                        {{data.item.estoque_history[data.item.estoque_history.length-1].saldo_estoque_e - data.item.estoque_history[0].saldo_estoque_e}}<br>\r\n                     <b>{{data.item.estoque_history[data.item.estoque_history.length-1].saldo_estoque}}</b>\r\n                    </div>\r\n\r\n\r\n                </template>\r\n\r\n                <template scope=\"data\" slot=\"top-row\" ><!-- eslint-disable-line-->\r\n                <td :key=\"field.key\" v-for=\"field in [...baseFields,...gradeFields,...valoresFields]\">\r\n                    <template v-if=\"field.key==='nom_marca'||field.key==='dat_cadastro'||field.key==='dat_ultcompra'||field.key==='cod_referencia'||field.key==='des_cor'||field.key==='des_produto'||field.key==='vlr_custo_bruto'||field.key==='vlr_venda1'\">\r\n                        <b-form-input :placeholder=\"field.label\" class=\"col-sm\" v-model=\"filters[field.key]\"></b-form-input>\r\n                    </template>\r\n                    <template v-else>\r\n<!--                        {{this.grade_estoque_totais}}-->\r\n<!--                        <div v-if=\"this.grade_estoque_totais[field.key+'_E'] && this.grade_estoque_totais[field.key]\">-->\r\n<!--                            <b>{{this.grade_estoque_totais[field.key+\"_E\"]}}</b>-->\r\n<!--                            {{this.grade_estoque_totais[field.key]}}-->\r\n<!--                        </div>-->\r\n                    </template>\r\n                </td>\r\n                </template>\r\n\r\n\r\n            </b-table>\r\n        </b-row>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {VueAutosuggest} from 'vue-autosuggest'\r\n    import axios from \"axios\";\r\n    import moment from \"moment\";\r\n    import DatePicker from 'vue2-datepicker'\r\n    import 'vue2-datepicker/index.css'\r\n    import 'vue2-datepicker/locale/pt-br'\r\n    // import Mydatepicker from '../components/Mydatepicker'\r\n    // import moment from \"moment\";\r\n\r\n    export default {\r\n        name: \"Estoque\",\r\n        components: {\r\n            'datepicker-ini': DatePicker,\r\n            'datepicker-fim': DatePicker,\r\n            'vue-autosuggest': VueAutosuggest\r\n        },\r\n        data() {\r\n            return {\r\n                cod_marca: 0, //olympikus = 567\r\n                // cod_marca: '567', //olympikus = 567\r\n                data_movto_ini: new Date('2019-01-01 03:00:00.000'),\r\n                // data_movto_ini: new Date('2019-01-01 03:00:00.000'),\r\n                data_movto_fim: new Date,\r\n                default_date: new Date('1900-01-01 01:00:00.000'),\r\n                // default_date: new Date('1900-01-01 01:00:00.000'),\r\n                filter: null,\r\n                filters: {nom_marca: '', dat_cadastro: '', des_cor: '', des_produto: ''},\r\n                grades_selected: [],\r\n                grade_estoque_totais: {},\r\n                grades_options: [\r\n                    {\r\n                        \"name\": 'Calçado Bebê',\r\n                        \"grade\": [{key: '1', label: '1'},\r\n                            {key: '2', label: '2'},\r\n                            {key: '3', label: '3'},\r\n                            {key: '4', label: '4'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Infantil PI-MI-GI',\r\n                        \"grade\": [\r\n                            {key: 'PI', label: 'PI'},\r\n                            {key: 'MI', label: 'MI'},\r\n                            {key: 'GI', label: 'GI'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Calçado Infantil',\r\n                        \"grade\": [\r\n                            {key: '15', label: '15'},\r\n                            {key: '16', label: '16'},\r\n                            {key: '17', label: '17'},\r\n                            {key: '18', label: '18'},\r\n                            {key: '19', label: '19'},\r\n                            {key: '20', label: '20'},\r\n                            {key: '21', label: '21'},\r\n                            {key: '22', label: '22'},\r\n                            {key: '23', label: '23'},\r\n                            {key: '24', label: '24'},\r\n                            {key: '25', label: '25'},\r\n                            {key: '26', label: '26'},\r\n                            {key: '27', label: '27'},\r\n                            {key: '28', label: '28'},\r\n                            {key: '29', label: '29'},\r\n                            {key: '30', label: '30'},\r\n                            {key: '31', label: '31'},\r\n                            {key: '32', label: '32'},\r\n                            {key: '33', label: '33'},\r\n                            {key: '34', label: '34'},\r\n                            {key: '35', label: '35'},\r\n                            {key: '36', label: '36'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Infantil 8-16',\r\n                        \"grade\": [\r\n                            {key: '8', label: '8'},\r\n                            {key: '10', label: '10'},\r\n                            {key: '12', label: '12'},\r\n                            {key: '14', label: '14'},\r\n                            {key: '16', label: '16'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Calçado Infantil Duplo',\r\n                        \"grade\": [{key: '17/18', label: '17/18'},\r\n                            {key: '19/20', label: '19/20'},\r\n                            {key: '21/22', label: '21/22'},\r\n                            {key: '23/24', label: '23/24'},\r\n                            {key: '25/26', label: '25/26'},\r\n                            {key: '27/28', label: '27/28'},\r\n                            {key: '29/30', label: '29/30'},\r\n                            {key: '31/32', label: '31/32'},\r\n                            {key: '33/34', label: '33/34'},\r\n                            {key: '35/36', label: '35/36'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Adulto PP',\r\n                        \"grade\": [\r\n                            {key: 'PP', label: 'PP'},\r\n                            {key: 'EP', label: 'EP'},]\r\n                    },\r\n                    {\r\n                        \"name\": 'Calçado Adulto',\r\n                        \"grade\": [{key: '33', label: '33'},\r\n                            {key: '34', label: '34'},\r\n                            {key: '35', label: '35'},\r\n                            {key: '36', label: '36'},\r\n                            {key: '37', label: '37'},\r\n                            {key: '38', label: '38'},\r\n                            {key: '39', label: '39'},\r\n                            {key: '40', label: '40'},\r\n                            {key: '41', label: '41'},\r\n                            {key: '42', label: '42'},\r\n                            {key: '43', label: '43'},\r\n                            {key: '44', label: '44'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Adulto 34-56',\r\n                        \"grade\": [\r\n                            {key: '34', label: '34'},\r\n                            {key: '36', label: '36'},\r\n                            {key: '38', label: '38'},\r\n                            {key: '40', label: '40'},\r\n                            {key: '42', label: '42'},\r\n                            {key: '44', label: '44'},\r\n                            {key: '46', label: '46'},\r\n                            {key: '48', label: '48'},\r\n                            {key: '50', label: '50'},\r\n                            {key: '52', label: '52'},\r\n                            {key: '54', label: '54'},\r\n                            {key: '56', label: '56'},\r\n                            {key: '58', label: '58'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Calçado Adulto Duplo',\r\n                        \"grade\": [\r\n                            {key: '33/34', label: '33/34'},\r\n                            {key: '35/36', label: '35/36'},\r\n                            {key: '37/38', label: '37/38'},\r\n                            {key: '39/40', label: '39/40'},\r\n                            {key: '41/42', label: '41/42'},\r\n                            {key: '43/44', label: '43/44'},\r\n                            {key: '45/46', label: '45/46'},\r\n                            {key: '47/48', label: '47/48'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Adulto P-M-G-GG',\r\n                        \"grade\": [\r\n                            {key: 'P', label: 'P'},\r\n                            {key: 'M', label: 'M'},\r\n                            {key: 'G', label: 'G'},\r\n                            {key: 'GG', label: 'GG'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Calçado Adulto Big',\r\n                        \"grade\": [{key: '45', label: '45'},\r\n                            {key: '46', label: '46'},\r\n                            {key: '47', label: '47'},\r\n                            {key: '48', label: '48'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Roupa Adulto XGs',\r\n                        \"grade\": [\r\n                            {key: 'XG', label: 'XG'},\r\n                            {key: 'X1', label: 'X1'},\r\n                            {key: 'X2', label: 'X2'},\r\n                            {key: 'X3', label: 'X3'},\r\n                            {key: 'GGG', label: 'GGG'},\r\n                            {key: 'EG', label: 'EG'},\r\n                            {key: 'EGG', label: 'EGG'},\r\n                            {key: 'EXGG', label: 'EXGG'},\r\n                            {key: 'G1', label: 'G1'},\r\n                            {key: 'G2', label: 'G2'},\r\n                            {key: 'G3', label: 'G3'},\r\n                            {key: 'G4', label: 'G4'},\r\n                            {key: '1G', label: '1G'},\r\n                            {key: '2G', label: '2G'},\r\n                            {key: '3G', label: '3G'},\r\n                            {key: '4G', label: '4G'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Cinto',\r\n                        \"grade\": [\r\n                            {key: '90', label: '90'},\r\n                            {key: '95', label: '95'},\r\n                            {key: '100', label: '100'},\r\n                            {key: '105', label: '105'},\r\n                            {key: '110', label: '110'},\r\n                            {key: '115', label: '115'},\r\n                            {key: '120', label: '120'}]\r\n                    },\r\n                    {\r\n                        \"name\": 'Img Link',\r\n                        \"grade\": {key: 'img_link', label: 'Img Link'}\r\n                    },\r\n                ],\r\n                items:[],\r\n                mapped_items: [],\r\n                marcas: {},\r\n                suggestion_selected: {\r\n                    cod_marca: 0,\r\n                    fornecedores: [{fan_fornecedor: ''}],\r\n                    nom_marca: \"carregando\",\r\n                },\r\n                suggestions: [\r\n                    {\r\n                        data: [\r\n                            {\r\n                                cod_marca: 0,\r\n                                fornecedores: [],\r\n                                nom_marca: \"carregando marcas\",\r\n                            }\r\n                        ]\r\n                    }\r\n                ],\r\n                marcas_suggestion_query: \"\"\r\n            };\r\n        },\r\n        computed: {\r\n            // saldoEstoque() {\r\n            //\r\n            // },\r\n            //TODO maybe one can speed code up with reduce instead of map+filter\r\n            mappedItemsComputed() {\r\n                const mapped_items = this.items.map((item) => {\r\n                    return {\r\n                        ...item,\r\n                        estoque_history: item.estoque_history.filter((movto) => {\r\n                            let data_aux =  new Date(movto.data_movto)\r\n                            if (data_aux > this.data_movto_ini && data_aux < this.data_movto_fim)\r\n                                return true\r\n                        })\r\n                    }\r\n                })\r\n                return mapped_items\r\n            },\r\n            filteredItemsComputed() {\r\n                return this.filteredItemsByDescription(this.items)\r\n            },\r\n\r\n            filteredmappedItemsComputed() {\r\n                const filtered = this.items.filter(item => {\r\n                // const filtered = this.mappedItemsComputed.filter(item => {\r\n                //     console.log(filtered)\r\n                    return Object.keys(this.filters).every(key =>{\r\n                        String(item[key].toString().toLowerCase()).includes(this.filters[key].toString().toLowerCase())\r\n                    }\r\n                    )\r\n                });\r\n                // console.log('filtered')\r\n                // console.log(filtered)\r\n                return filtered\r\n                // return this.items\r\n            },\r\n            computedFields() {\r\n                // return [].concat(this.baseFields, this.adultoFields, this.valoresFields)\r\n                return [].concat(this.baseFields, this.gradeFields, this.valoresFields)\r\n                // return [].concat(this.baseFields, this.gradeFields, this.totaisFields, this.valoresFields)\r\n            },\r\n            gradeFields() {\r\n                var grades = this.grades_selected.map(selected => {\r\n                    return selected.grade\r\n                })\r\n                // return [].concat(grades.flat(1)) //manter totaisFields aqui para que os totais fiquem corretos\r\n                return [].concat(grades.flat(1), this.totaisFields) //manter totaisFields aqui para que os totais fiquem corretos\r\n                // return [].concat(this.infantoFields, this.adultoFields, this.totaisFields)\r\n            },\r\n            baseFields() {\r\n                return [\r\n                    {key: 'selected', label: 'Sel.'},\r\n                    {key: 'nom_marca', label: 'Nom. Marca', sortable: true},\r\n                    {key: 'dat_cadastro', label: 'Data Cad.', sortable: true},\r\n                    {key: 'dat_ultcompra', label: 'Data UltCompra', sortable: true},\r\n                    {key: 'cod_referencia', label: 'Ref.', sortable: true},\r\n                    {key: 'des_cor', label: 'Cor', sortable: true},\r\n                    {key: 'img', label: 'Img.'},\r\n                    {key: 'img_link', label: 'Img Link'},\r\n                    {key: 'des_produto', label: 'Descrição.', sortable: true},\r\n                    {key: 'actions', label: '+'}\r\n                ]\r\n            },\r\n            valoresFields() {\r\n                return [\r\n                    // {key: 'totais', label: 'Tot.', sortable: true},\r\n                    {key: 'vlr_custo_bruto', label: 'Custo', sortable: true},\r\n                    {key: 'vlr_venda1', label: 'Vlr. Venda', sortable: true}\r\n                ]\r\n            },\r\n            totaisFields() {\r\n                return [\r\n                    {key: 'totais', label: 'Tot.', sortable: true},\r\n                    {key: 'saidas', label: 'Saídas.', sortable: true}\r\n                ]\r\n            },\r\n            filteredOptions() {\r\n                return [\r\n                    {\r\n                        // data: this.marcas\r\n                        data: this.suggestions[0].data\r\n                            .filter(option => {\r\n                                // return 'a'\r\n                                return option.nom_marca.toLowerCase().indexOf(this.marcas_suggestion_query.toLowerCase()) > -1;\r\n                            })\r\n                            .map(filtered_items => {\r\n                                const mapped_items = filtered_items;\r\n                                return mapped_items;\r\n                            })\r\n                    }\r\n                ];\r\n            }\r\n\r\n            // gradeTotals() {\r\n            //     let sum = this.filteredItemsComputed.reduce(function (sum, item) {\r\n            //     let itemValor = parseFloat(item.grade_estoque[0])\r\n            //     if (!isNaN(itemValor)) {\r\n            //         return sum + itemValor\r\n            //     } else {\r\n            //         return sum\r\n            //     }\r\n            // }, 0)\r\n            // return sum\r\n            // }\r\n        },\r\n\r\n        beforeMount() {\r\n            this.loadMarcas()\r\n            // this.grade_estoque_totais= {'33':0}\r\n            // this.updateEstoqueProdutos()\r\n        },\r\n        methods: {\r\n            filteredItemsByDescription:function(items){\r\n                // console.log(items)\r\n                return items.filter(item => !item.des_produto.toLowerCase().indexOf(this.filters.des_produto))\r\n\r\n            //    TODO\r\n            //    des_cor in FERRACINI = null sometimes, find a way to bypass\r\n            //    chaining filters like below might work\r\n            //    https://5balloons.info/combining-multiple-filters-on-list-using-computed-properties-in-vuejs/\r\n\r\n            },\r\n            receiveDataMovtoIni(value) {\r\n                this.data_movto_ini = value\r\n            },\r\n            receiveDataMovtoFim(value) {\r\n                this.data_movto_fim = value\r\n            },\r\n            loadMarcas() {\r\n                const path = `/api/read/marcas/`;\r\n                // const path = `http://localhost/api/read/marcas/`; //this way works\r\n                axios.get(path)\r\n                    .then((res) => {\r\n                        // console.log('res_marcas');\r\n                        // console.log(res);\r\n                        this.marcas = res.data\r\n                        this.suggestions[0].data = res.data\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error)\r\n                        console.log(error.response.data); // => the response payload\r\n                    })\r\n            },\r\n            clickHandler(item) {\r\n                console.log(item)\r\n                // event fired when clicking on the input\r\n            },\r\n            onSelected(item) {\r\n                this.suggestion_selected = item.item;\r\n                // this.form_selected = this.availableFornecedores\r\n            },\r\n            onInputChange(text) {\r\n                console.log(text)\r\n            },\r\n            /**\r\n             * This is what the <input/> value is set to when you are selecting a suggestion.\r\n             */\r\n            getSuggestionValue(suggestion) {\r\n                return suggestion.item.nom_marca;\r\n            },\r\n            focusMe(e) {\r\n                console.log(e) // FocusEvent\r\n            },\r\n            estoqueHistoryBoundDates(object) {\r\n                var date_array = Object.keys(object)\r\n                var date_diff_min = 0;\r\n                var date_diff_max = 0;\r\n                var estoque_history_bound_dates = {\r\n                    'data_ini': this.default_date,\r\n                    'data_fim': this.default_date\r\n                }\r\n\r\n                if (this.data_movto_ini < this.data_movto_fim) {\r\n                    for (let i = 0; i < date_array.length; i++) {\r\n                        date_diff_min = new Date(date_array[i]) - this.data_movto_ini;\r\n                        if (date_diff_min > 0) {\r\n                            if (i > 0) {\r\n                                estoque_history_bound_dates.data_ini = date_array[i - 1]\r\n                            }\r\n                            break\r\n                        }\r\n                    }\r\n\r\n                    for (let i = date_array.length; i > 0; i--) {\r\n                        date_diff_max = new Date(date_array[i]) - this.data_movto_fim;\r\n                        if (date_diff_max < 0) {\r\n                            estoque_history_bound_dates.data_fim = date_array[i];\r\n                            break\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return estoque_history_bound_dates\r\n            },\r\n            gradeTotals(object) {\r\n                let totais_E = Object.keys(object).reduce(function (sum, key) {\r\n                    return sum + (key.slice(-1) == 'E' && object[key]);\r\n                }, 0);\r\n\r\n                let totais = Object.keys(object).reduce(function (sum, key) {\r\n                    return sum + (key.slice(-1) !== 'E' && object[key]);\r\n                }, 0);\r\n                return {'totais_E':totais_E, 'totais': totais}\r\n            },\r\n            gradeEstoque(object) {\r\n                // console.log(object)\r\n                var grade_estoque = Object.values(object)\r\n                // console.log(\"grade_estoque\")\r\n                // console.log(grade_estoque)\r\n                // console.log(\"grade_estoque[grade_estoque.lenght - 1]\")\r\n                // console.log(grade_estoque[grade_estoque.lenght - 1])\r\n                return grade_estoque[grade_estoque.lenght - 1]\r\n\r\n            },\r\n    normalizeString(s) {\r\n      return `${s}`.trim().toLowerCase();\r\n    },\r\n    filterFn(row) {\r\n      return this.filter.split(',')\r\n        .map(this.normalizeString)\r\n        .some(\r\n          term => Object.values(row)\r\n            .map(this.normalizeString)\r\n            .some(\r\n              val => val.indexOf(term) > -1\r\n            )\r\n        );\r\n    },\r\n            expandAdditionalInfo(row) {\r\n                row._showDetails = !row._showDetails;\r\n            },\r\n            readProdutosFromMongo() {\r\n                const path = `/api/estoque/read_produtos_from_mongo_db/${this.suggestion_selected.cod_marca}`\r\n                // const path = `/api/estoque/read_produtos_from_mongo_db/${this.cod_marca}`\r\n                console.log(path)\r\n                axios.get(path)\r\n                    .then((produtos) => {\r\n                        // console.log(\"produtos\")\r\n                        // console.log(produtos)\r\n                        this.items = produtos.data\r\n                        // console.log(\"this.items\")\r\n                        // console.log(this.items)\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error)\r\n                    })\r\n            },\r\n            updateEstoqueProdutos() {\r\n                // this.data_movto_ini = '2000-01-01T11%3A18%3A26.989000'\r\n                this.data_movto_ini = '2000-01-01 01:01:01.000000'\r\n                // this.data_movto_ini = moment(new Date).format('YYYY-MM-DDTHH:mm:ss.SSSSSS')\r\n                this.cod_marca = '567'\r\n\r\n                const path = `/api/estoque/read_produtos_from_postgres_db/${this.cod_marca}/${this.data_movto_ini}`\r\n                axios.get(path)\r\n                    .then((produtos_da_marca) => {\r\n                        console.log(\"produtos_da_marca\")\r\n                        console.log(produtos_da_marca)\r\n                        // this.items = produtos_da_marca.data\r\n                        // console.log(\"this.items\")\r\n                        // console.log(this.items)\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error)\r\n                    })\r\n            },\r\n            dateSorter(a, b, key) {\r\n\r\n                if (key === 'dat_ultcompra' || key === 'dat_cadastro'|| key === 'data_movto') {\r\n                    if (moment(a[key], 'DD/MM/YYYY').toDate() > moment(b[key], 'DD/MM/YYYY').toDate()) return 1;\r\n                    if (moment(a[key], 'DD/MM/YYYY').toDate() < moment(b[key], 'DD/MM/YYYY').toDate()) return -1;\r\n                    return 0;\r\n                } else {\r\n                    return false       // If field is not `date` we let b-table handle the sorting\r\n                }\r\n            },\r\n        },\r\n        watch: {\r\n        }\r\n    }\r\n</script>\r\n\r\n\r\n<style>\r\n    /*<style scoped>*/\r\n    .autosuggest-container {\r\n        position: absolute;\r\n        display: flex;\r\n        justify-content: center;\r\n        width: 280px;\r\n\r\n    }\r\n\r\n    .autosuggest__results {\r\n        z-index: 1000;\r\n        position: absolute;\r\n        display: flex;\r\n        /*justify-content: center;*/\r\n        /*width: 280px;*/\r\n        background-color: #fff;\r\n        background-clip: padding-box;\r\n        border: 1px solid rgba(0, 0, 0, .15);\r\n        border-radius: .25rem;\r\n\r\n    }\r\n\r\n\r\n</style>"]}]}